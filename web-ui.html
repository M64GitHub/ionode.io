<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>IOnode Config</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
--bg:#08090e;--bg2:#0d1019;--bg3:#141822;
--accent:#ff8c00;--accent-dim:rgba(255,140,0,0.15);--accent-glow:rgba(255,140,0,0.25);
--text:#e8eaf0;--text2:#8b92a8;--text3:#4a5068;
--border:rgba(255,255,255,0.06);--border-a:rgba(255,140,0,0.25);
--red:#ff4757;
--font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
--mono:"SF Mono","Cascadia Code","Fira Code",Consolas,monospace;
}
body{font-family:var(--font);background:var(--bg);color:var(--text);min-height:100vh}
.wrap{max-width:640px;margin:0 auto;padding:1rem}
header{display:flex;align-items:center;gap:0.75rem;margin-bottom:1.5rem}
header h1{font-size:1.25rem;font-weight:700}
header .ver{font-family:var(--mono);font-size:0.75rem;color:var(--accent);background:var(--accent-dim);
border:1px solid var(--border-a);border-radius:9999px;padding:0.2rem 0.6rem}
header .demo{font-family:var(--mono);font-size:0.75rem;color:var(--red);background:rgba(255,71,87,0.12);
border:1px solid rgba(255,71,87,0.25);border-radius:9999px;padding:0.2rem 0.6rem}
nav{display:flex;gap:0.5rem;margin-bottom:1.5rem;border-bottom:1px solid var(--border);padding-bottom:0.5rem}
nav button{background:none;border:none;color:var(--text2);font-family:var(--font);font-size:0.9rem;
font-weight:500;padding:0.5rem 1rem;cursor:pointer;border-radius:8px 8px 0 0;
border-bottom:2px solid transparent;transition:all 0.15s}
nav button:hover{color:var(--text)}
nav button.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab{display:none}.tab.active{display:block}
.card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1rem}
label{display:block;font-size:0.8rem;color:var(--accent);font-weight:600;margin:1rem 0 0.25rem;
font-family:var(--mono);text-transform:uppercase;letter-spacing:0.04em}
label:first-child{margin-top:0}
input[type=text],input[type=password],input[type=number],select{width:100%;padding:0.6rem 0.75rem;
background:var(--bg2);border:1px solid var(--border);border-radius:8px;color:var(--text);
font-family:var(--mono);font-size:0.85rem;transition:border-color 0.15s}
input:focus,select:focus{outline:none;border-color:var(--border-a)}
select{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%238b92a8'%3E%3Cpath d='M6 8L1 3h10z'/%3E%3C/svg%3E");
background-repeat:no-repeat;background-position:right 0.75rem center;padding-right:2rem}
textarea{width:100%;padding:0.75rem;background:var(--bg2);border:1px solid var(--border);
border-radius:8px;color:var(--text);font-family:var(--mono);font-size:0.85rem;
resize:vertical;min-height:200px;line-height:1.6;transition:border-color 0.15s}
textarea:focus{outline:none;border-color:var(--border-a)}
.hint{font-size:0.75rem;color:var(--text3);margin-top:0.2rem}
.btn{display:inline-flex;align-items:center;gap:0.5rem;padding:0.6rem 1.25rem;border:none;
border-radius:8px;font-weight:600;font-size:0.9rem;cursor:pointer;transition:all 0.2s;
font-family:var(--font)}
.btn-primary{background:var(--accent);color:var(--bg)}
.btn-primary:hover{box-shadow:0 0 20px var(--accent-glow)}
.btn-danger{background:var(--red);color:#fff}
.btn-danger:hover{box-shadow:0 0 20px rgba(255,71,87,0.3)}
.btn-outline{background:transparent;color:var(--text);border:1px solid var(--border-a)}
.btn-outline:hover{border-color:var(--accent);color:var(--accent)}
.actions{display:flex;gap:0.75rem;margin-top:1.25rem;flex-wrap:wrap}
.sep{border-top:1px solid var(--border);margin:1rem 0}
.toast{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);padding:0.6rem 1.25rem;
border-radius:8px;font-size:0.85rem;font-weight:500;z-index:999;opacity:0;
transition:opacity 0.3s;pointer-events:none}
.toast.show{opacity:1}
.toast.ok{background:var(--accent);color:var(--bg)}
.toast.err{background:var(--red);color:#fff}
.status-grid{display:grid;grid-template-columns:1fr 1fr;gap:0.75rem}
.status-item{background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:0.75rem}
.status-item .label{font-size:0.7rem;color:var(--text3);font-family:var(--mono);
text-transform:uppercase;letter-spacing:0.04em;margin-bottom:0.25rem}
.status-item .value{font-size:0.95rem;color:var(--text);font-family:var(--mono);word-break:break-all}
.status-item .value.accent{color:var(--accent)}
.status-item.full{grid-column:1/-1}
.dev{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:1rem;margin-bottom:0.75rem}
.dev-hdr{display:flex;align-items:center;gap:0.5rem;margin-bottom:0.4rem}
.dev-name{font-family:var(--mono);font-size:0.85rem;color:var(--accent);font-weight:600}
.kind-badge{font-size:0.65rem;font-weight:700;font-family:var(--mono);padding:0.15rem 0.5rem;
border-radius:9999px;letter-spacing:0.04em;background:var(--accent-dim);color:var(--accent);border:1px solid var(--border-a)}
.del{background:none;border:none;color:var(--text3);font-size:1.1rem;cursor:pointer;
padding:0.1rem 0.4rem;border-radius:4px;line-height:1;transition:all 0.15s;margin-left:auto}
.del:hover{color:var(--red);background:rgba(255,71,87,0.12)}
.dev-meta{font-family:var(--mono);font-size:0.75rem;color:var(--text2);margin-bottom:0.3rem}
.spark{display:flex;align-items:flex-end;gap:2px;height:20px;margin-top:4px}
.spark-bar{width:6px;background:var(--accent);border-radius:1px;min-height:2px}
.toggle-wrap{display:flex;gap:0.5rem;margin-top:0.4rem}
.toggle-btn{padding:0.3rem 0.8rem;border:1px solid var(--border);border-radius:6px;
font-family:var(--mono);font-size:0.8rem;cursor:pointer;background:var(--bg2);color:var(--text2);transition:all 0.15s}
.toggle-btn.on{background:var(--accent-dim);color:var(--accent);border-color:var(--border-a)}
.toggle-btn.off-active{background:rgba(255,71,87,0.12);color:var(--red);border-color:rgba(255,71,87,0.25)}
.pwm-wrap{display:flex;align-items:center;gap:0.75rem;margin-top:0.4rem}
.pwm-wrap input[type=range]{flex:1;accent-color:var(--accent);height:6px}
.pwm-val{font-family:var(--mono);font-size:0.85rem;color:var(--accent);min-width:3ch;text-align:right}
input[type=color]{width:40px;height:32px;border:1px solid var(--border);border-radius:6px;
background:var(--bg2);cursor:pointer;padding:2px}
.pin-result{margin-top:0.75rem;padding:0.6rem;background:var(--bg2);border:1px solid var(--border);
border-radius:8px;font-family:var(--mono);font-size:0.85rem;color:var(--accent);min-height:2em}
.empty{text-align:center;color:var(--text3);padding:2rem 0;font-size:0.9rem}
.hidden{display:none}
@media(max-width:480px){
.wrap{padding:0.75rem}
.card{padding:1rem}
.status-grid{grid-template-columns:1fr}
nav button{padding:0.4rem 0.6rem;font-size:0.8rem}
}
</style></head><body>
<div class="wrap">
<header>
<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none"><rect x="4" y="4" width="24" height="24" rx="4" stroke="var(--accent)" stroke-width="2"/><circle cx="16" cy="16" r="4" fill="var(--accent)"/><line x1="16" y1="4" x2="16" y2="10" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/><line x1="16" y1="22" x2="16" y2="28" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/><line x1="4" y1="16" x2="10" y2="16" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/><line x1="22" y1="16" x2="28" y2="16" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"/></svg>
<h1>IOnode</h1>
<span class="ver">v0.1.0</span>
<span class="demo">Demo</span>
</header>
<nav>
<button class="active" onclick="showTab('config',this)">Config</button>
<button onclick="showTab('devices',this)">Devices</button>
<button onclick="showTab('pins',this)">Pins</button>
<button onclick="showTab('status',this)">Status</button>
</nav>

<div id="config" class="tab active">
<div class="card">
<label>WiFi SSID</label>
<input type="text" id="c_wifi_ssid">
<label>WiFi Password</label>
<input type="password" id="c_wifi_pass">
<div class="sep"></div>
<label>Device Name</label>
<input type="text" id="c_device_name">
<div class="sep"></div>
<label>NATS Host</label>
<input type="text" id="c_nats_host">
<label>NATS Port</label>
<input type="number" id="c_nats_port">
<div class="sep"></div>
<label>Timezone</label>
<input type="text" id="c_timezone">
<p class="hint">POSIX TZ string, e.g. CET-1CEST,M3.5.0,M10.5.0/3</p>
<div class="actions">
<button class="btn btn-primary" onclick="demoToast()">Save Config</button>
<button class="btn btn-danger" onclick="demoToast()">Reboot</button>
</div>
<p class="hint" style="margin-top:0.75rem">Reboot required to apply config changes.</p>
</div>

<div class="card">
<label>devices.json</label>
<textarea id="dj_text" rows="8" readonly></textarea>
<div class="actions" id="dj_actions_view">
<button class="btn btn-outline" onclick="djEdit()">Edit</button>
<button class="btn btn-outline" onclick="djLoad()">Reload</button>
</div>
<div class="actions hidden" id="dj_actions_edit">
<button class="btn btn-primary" onclick="djSave()">Save JSON</button>
<button class="btn btn-outline" onclick="djCancel()">Cancel</button>
</div>
<p class="hint" style="margin-top:0.75rem">Direct edit for power users. Use the Devices tab to add/remove devices normally.</p>
</div>
</div>

<div id="devices" class="tab">
<div class="card">
<label>Add Device</label>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:0.5rem;margin-top:0.5rem">
<div>
<label style="margin-top:0">Name</label>
<input type="text" id="ad_name" placeholder="e.g. led1">
</div>
<div>
<label style="margin-top:0">Kind</label>
<select id="ad_kind" onchange="adKindChange()">
<option value="ntc_10k">ntc_10k</option>
<option value="ldr">ldr</option>
<option value="analog_in">analog_in</option>
<option value="digital_in">digital_in</option>
<option value="digital_out">digital_out</option>
<option value="relay">relay</option>
<option value="pwm">pwm</option>
<option value="serial_text">serial_text</option>
</select>
</div>
</div>
<div id="ad_pin_wrap">
<label>Pin</label>
<input type="number" id="ad_pin" placeholder="GPIO number">
</div>
<div id="ad_inv_wrap" class="hidden">
<label><input type="checkbox" id="ad_inv"> Inverted</label>
</div>
<div id="ad_baud_wrap" class="hidden">
<label>Baud Rate</label>
<input type="number" id="ad_baud" value="9600">
</div>
<div class="actions">
<button class="btn btn-primary" onclick="addDevice()">Add Device</button>
</div>
</div>

<div id="devices-list"></div>
</div>

<div id="pins" class="tab">
<div class="card">
<label>Pin Control</label>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:0.5rem;margin-top:0.5rem">
<div>
<label style="margin-top:0">Pin</label>
<input type="number" id="pin_num" placeholder="GPIO number">
</div>
<div>
<label style="margin-top:0">Type</label>
<select id="pin_type" onchange="pinTypeChange()">
<option value="GPIO">GPIO</option>
<option value="ADC">ADC</option>
<option value="PWM">PWM</option>
</select>
</div>
</div>
<div id="pin_val_wrap">
<label>Value</label>
<input type="number" id="pin_val" placeholder="0 or 1 for GPIO, 0-255 for PWM">
</div>
<div class="actions">
<button class="btn btn-outline" onclick="pinAction('read')">Read</button>
<button class="btn btn-primary" id="pin_write_btn" onclick="pinAction('write')">Write</button>
</div>
<div class="pin-result" id="pin_result"></div>
</div>
</div>

<div id="status" class="tab">
<div class="card">
<div class="status-grid" id="status-grid"></div>
<div class="actions">
<button class="btn btn-outline" onclick="loadStatus()">Refresh</button>
<button class="btn btn-danger" onclick="demoToast()">Reboot</button>
</div>
</div>
</div>
</div>

<div class="toast" id="toast"></div>

<script>
/* Mock data */
var mockConfig={
wifi_ssid:"MyNetwork",wifi_pass:"...word",
device_name:"ionode-01",nats_host:"192.168.1.10",
nats_port:"4222",timezone:"CET-1CEST,M3.5.0,M10.5.0/3"
};

var mockDevicesJson=[
{n:"chip_temp",k:"internal_temp",p:255},
{n:"clock_hour",k:"clock_hour",p:255},
{n:"clock_minute",k:"clock_minute",p:255},
{n:"clock_hhmm",k:"clock_hhmm",p:255},
{n:"temp_ext",k:"ntc_10k",p:35},
{n:"light",k:"ldr",p:34},
{n:"power",k:"nats_value",p:255,x:"home.power"},
{n:"gate",k:"digital_in",p:4},
{n:"pump",k:"relay",p:7,i:true},
{n:"fan",k:"digital_out",p:8},
{n:"dimmer",k:"pwm",p:6},
{n:"status_led",k:"rgb_led",p:8}
];

var mockDevices=[
{name:"chip_temp",kind:"internal_temp",pin:"virtual",value:"38.7 C",extra:"",msg:"",internal:true,raw:38.7,hist:[36.2,36.8,37.1,37.5,37.9,38.1,38.4,38.7]},
{name:"clock_hour",kind:"clock_hour",pin:"virtual",value:"14.0 h",extra:"",msg:"",internal:true,raw:14,hist:[]},
{name:"clock_minute",kind:"clock_minute",pin:"virtual",value:"22.0 m",extra:"",msg:"",internal:true,raw:22,hist:[]},
{name:"clock_hhmm",kind:"clock_hhmm",pin:"virtual",value:"1422.0",extra:"",msg:"",internal:true,raw:1422,hist:[]},
{name:"temp_ext",kind:"ntc_10k",pin:"35",value:"22.5 C",extra:"",msg:"",internal:false,raw:22.5,hist:[21.8,22.0,22.1,22.3,22.4,22.5]},
{name:"light",kind:"ldr",pin:"34",value:"67.2 %",extra:"",msg:"",internal:false,raw:67.2,hist:[45,52,58,63,65,67.2]},
{name:"power",kind:"nats_value",pin:"virtual",value:"2450.0 W",extra:"home.power",msg:"Power spike detected",internal:false,raw:2450,hist:[1200,1800,2100,2300,2450]},
{name:"gate",kind:"digital_in",pin:"4",value:"1.0",extra:"",msg:"",internal:false,raw:1,hist:[]},
{name:"pump",kind:"relay",pin:"7",value:"OFF",extra:"",msg:"",internal:false,raw:0,hist:[]},
{name:"fan",kind:"digital_out",pin:"8",value:"ON",extra:"",msg:"",internal:false,raw:1,hist:[]},
{name:"dimmer",kind:"pwm",pin:"6",value:"128/255",extra:"",msg:"",internal:false,raw:128,hist:[]},
{name:"status_led",kind:"rgb_led",pin:"8",value:"#ff8c00",extra:"",msg:"",internal:false,raw:0xff8c00,hist:[]}
];

var mockStatus={
version:"0.1.0",device_name:"ionode-01",
uptime:"1d 4h 37m 12s",uptime_seconds:103032,
heap_free:245760,heap_total:327680,
wifi_ssid:"MyNetwork",wifi_ip:"192.168.1.42",
wifi_rssi:-48,nats:"connected"
};

function showTab(id,btn){
document.querySelectorAll('.tab').forEach(function(t){t.classList.remove('active')});
document.querySelectorAll('nav button').forEach(function(b){b.classList.remove('active')});
document.getElementById(id).classList.add('active');
if(btn)btn.classList.add('active');
if(id==='status')loadStatus();
if(id==='devices')loadDevices();
if(id==='config')djLoad();
}

function toast(msg,ok){
var t=document.getElementById('toast');
t.textContent=msg;t.className='toast show '+(ok?'ok':'err');
setTimeout(function(){t.className='toast'},2500);
}

function demoToast(){
toast('This is a demo \u2014 on your ESP32, this saves to flash!',true);
}

/* Config tab */
function loadConfig(){
var f=['wifi_ssid','wifi_pass','device_name','nats_host','nats_port','timezone'];
f.forEach(function(k){var el=document.getElementById('c_'+k);if(el)el.value=mockConfig[k]||''});
}

/* devices.json editor */
function djLoad(){
document.getElementById('dj_text').value=JSON.stringify(mockDevicesJson,null,2);
}
function djEdit(){
document.getElementById('dj_text').removeAttribute('readonly');
document.getElementById('dj_actions_view').classList.add('hidden');
document.getElementById('dj_actions_edit').classList.remove('hidden');
}
function djCancel(){
document.getElementById('dj_text').setAttribute('readonly','');
document.getElementById('dj_actions_view').classList.remove('hidden');
document.getElementById('dj_actions_edit').classList.add('hidden');
djLoad();
}
function djSave(){
var t=document.getElementById('dj_text').value;
try{JSON.parse(t)}catch(e){toast('Invalid JSON: '+e.message,false);return}
document.getElementById('dj_text').setAttribute('readonly','');
document.getElementById('dj_actions_view').classList.remove('hidden');
document.getElementById('dj_actions_edit').classList.add('hidden');
demoToast();
}

/* Add device form */
function adKindChange(){
var k=document.getElementById('ad_kind').value;
document.getElementById('ad_pin_wrap').classList.toggle('hidden',k==='serial_text');
document.getElementById('ad_inv_wrap').classList.toggle('hidden',k!=='relay');
document.getElementById('ad_baud_wrap').classList.toggle('hidden',k!=='serial_text');
}
function addDevice(){
var name=document.getElementById('ad_name').value.trim();
var kind=document.getElementById('ad_kind').value;
if(!name){toast('Name required',false);return}
if(kind!=='serial_text'){
var pin=parseInt(document.getElementById('ad_pin').value);
if(isNaN(pin)){toast('Pin required',false);return}
}
/* Check for duplicate name */
for(var i=0;i<mockDevices.length;i++){
if(mockDevices[i].name===name){toast('Name already exists',false);return}
}
var isActuator=kind==='digital_out'||kind==='relay'||kind==='pwm'||kind==='rgb_led';
var pinStr=kind==='serial_text'?'virtual':String(pin);
var val=isActuator?'0':'0.0';
mockDevices.push({name:name,kind:kind,pin:pinStr,value:val,extra:'',msg:'',internal:false,raw:0,hist:[]});
document.getElementById('ad_name').value='';
loadDevices();
toast('Device added',true);
}

/* Device list */
function loadDevices(){
var c=document.getElementById('devices-list');
if(!mockDevices.length){c.innerHTML='<div class="empty">No devices registered.</div>';return}
var h='';mockDevices.forEach(function(d){
h+='<div class="dev"><div class="dev-hdr"><span class="dev-name">'+d.name+'</span>';
h+='<span class="kind-badge">'+d.kind+'</span>';
if(!d.internal)h+='<button class="del" onclick="deleteDevice(\''+d.name+'\')">&times;</button>';
h+='</div>';
if(d.kind==='rgb_led'){
var hex='#'+('000000'+d.raw.toString(16)).slice(-6);
h+='<div class="dev-meta">pin '+d.pin+'</div>';
h+='<div class="pwm-wrap"><input type="color" value="'+hex+'" onchange="setRgb(\''+d.name+'\',this.value)"><span class="pwm-val">'+hex+'</span>';
h+='<button class="toggle-btn'+(d.raw===0?' off-active':'')+'" onclick="setDev(\''+d.name+'\',0)" style="margin-left:0.5rem">OFF</button></div>';
}else if(d.kind==='digital_out'||d.kind==='relay'){
var isOn=d.raw!==0;
h+='<div class="dev-meta">pin '+d.pin+'</div>';
h+='<div class="toggle-wrap">';
h+='<button class="toggle-btn'+(isOn?' on':'')+'" onclick="setDev(\''+d.name+'\',1)">ON</button>';
h+='<button class="toggle-btn'+(!isOn?' off-active':'')+'" onclick="setDev(\''+d.name+'\',0)">OFF</button>';
h+='</div>';
}else if(d.kind==='pwm'){
h+='<div class="dev-meta">pin '+d.pin+'</div>';
h+='<div class="pwm-wrap"><input type="range" min="0" max="255" value="'+d.raw+'" oninput="pwmSlide(this,\''+d.name+'\')"><span class="pwm-val">'+d.raw+'</span></div>';
}else{
if(d.pin!=='virtual')h+='<div class="dev-meta">pin '+d.pin+'</div>';
else if(d.extra)h+='<div class="dev-meta">'+d.extra+'</div>';
h+='<div class="dev-meta">'+d.value+'</div>';
if(d.msg)h+='<div class="dev-meta" style="color:var(--text3)">"'+d.msg+'"</div>';
}
if(d.hist&&d.hist.length>1){var mn=Math.min.apply(null,d.hist),mx=Math.max.apply(null,d.hist),rng=mx-mn||1,bars='';d.hist.forEach(function(v){var pct=Math.round(((v-mn)/rng)*100);bars+='<span class="spark-bar" style="height:'+Math.max(pct,5)+'%"></span>'});h+='<div class="spark">'+bars+'</div>'}
h+='</div>'});
c.innerHTML=h;
}

/* Device controls */
var pwmTimers={};
function pwmSlide(el,name){
el.nextElementSibling.textContent=el.value;
if(pwmTimers[name])clearTimeout(pwmTimers[name]);
pwmTimers[name]=setTimeout(function(){setDev(name,parseInt(el.value))},300);
}
function setDev(name,val){
for(var i=0;i<mockDevices.length;i++){
if(mockDevices[i].name===name){
mockDevices[i].raw=val;
if(mockDevices[i].kind==='digital_out'||mockDevices[i].kind==='relay')
mockDevices[i].value=val?'ON':'OFF';
else if(mockDevices[i].kind==='pwm')
mockDevices[i].value=val+'/255';
else if(mockDevices[i].kind==='rgb_led')
mockDevices[i].value='#'+('000000'+val.toString(16)).slice(-6);
break;
}
}
loadDevices();
}
function setRgb(name,hex){
var v=parseInt(hex.slice(1),16);
setDev(name,v);
}
function deleteDevice(name){
if(!confirm('Delete device "'+name+'"?'))return;
mockDevices=mockDevices.filter(function(d){return d.name!==name});
loadDevices();
toast('Deleted '+name,true);
}

/* Status tab */
function loadStatus(){
var d=mockStatus;
var items=[
{l:'Version',v:d.version,cls:'accent'},
{l:'Device',v:d.device_name},
{l:'Uptime',v:d.uptime},
{l:'Heap',v:Math.round(d.heap_free/1024)+'KB / '+Math.round(d.heap_total/1024)+'KB'},
{l:'WiFi',v:d.wifi_ssid+' ('+d.wifi_rssi+'dBm)',full:true},
{l:'IP Address',v:d.wifi_ip,cls:'accent'},
{l:'NATS',v:d.nats}
];
var h='';items.forEach(function(i){
h+='<div class="status-item'+(i.full?' full':'')+'"><div class="label">'+i.l+
'</div><div class="value'+(i.cls?' '+i.cls:'')+'">'+i.v+'</div></div>';
});
document.getElementById('status-grid').innerHTML=h;
}

/* Pins tab */
function pinTypeChange(){
var t=document.getElementById('pin_type').value;
var vw=document.getElementById('pin_val_wrap');
var wb=document.getElementById('pin_write_btn');
if(t==='ADC'){vw.classList.add('hidden');wb.classList.add('hidden')}
else{vw.classList.remove('hidden');wb.classList.remove('hidden')}
}
function pinAction(action){
var pin=parseInt(document.getElementById('pin_num').value);
if(isNaN(pin)){toast('Enter a pin number',false);return}
var type=document.getElementById('pin_type').value;
var el=document.getElementById('pin_result');
if(action==='read'){
if(type==='ADC')el.textContent='ADC pin '+pin+' = '+Math.floor(Math.random()*4096);
else if(type==='PWM')el.textContent='PWM pin '+pin+' = 0';
else el.textContent='GPIO pin '+pin+' = '+Math.round(Math.random());
}else{
var val=parseInt(document.getElementById('pin_val').value)||0;
el.textContent=type+' pin '+pin+' \u2190 '+val+' OK';
}
}

/* Init */
loadConfig();
djLoad();
</script>
</body></html>
